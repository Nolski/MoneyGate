<!DOCTYPE html>
<html ng-app="moneyGateApp">
    <head>
        <title>Political Party Crasher</title>
        <link href='http://fonts.googleapis.com/css?family=Roboto:400,300,100,700' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="bower_components/leaflet/dist/leaflet.css"/>
        <link rel="stylesheet" href="bower_components/leaflet-sidebar/src/L.Control.Sidebar.css"/>
        <link rel="stylesheet" href="css/style.css"/>
    </head>
    <body ng-controller="MapCtrl">
        <div id="map"></div>
        <div id="sidebar">
            <h1 class="legislator-info-header">Legislator Info</h1>
            <ul class="legislators">
                <li class="legislator" ng-repeat="legislator in legislators">
                    <div class="legislator-header">
                        <h2 class="legislator-name">{{legislator.first_name}} {{legislator.last_name}}</h2>
                        <h2 class="legislator-party">{{legislator.party}}</h2>
                    </div>
                    <div class="legislator-info">
                        <h4 class="legislator-chamber">{{chamber[legislator.chamber]}}</h4>
                        <p>Term: {{legislator.term_start}} - {{legislator.term_end}}</p>
                    </div>
                    <mini-chart chart-data="legislator"></mini-chart>
                    <div class="legislator-footer">
                        <a href="http://twitter.com/{{legislator.twitter_id}}">Twitter</a> | <a href="http://youtube.com/user/{{legislator.youtube_id}}">Youtube</a> | <a href="https://facebook.com/{{legislator.facebook_id}}">Facebook</a> | <a href="{{legislator.website}}">Website</a> </div> </li> </ul>
        </div>
        <button class="install-button" onclick="install()">Install on FirefoxOS</button>
        <script src="js/scripts.min.js"></script>
        <script>
            if(navigator.mozApps !== undefined) {
                var request = navigator.mozApps.checkInstalled("http://nolski.rocks/firefox/manifest.webapp");
                request.onsuccess = function() {
                    if (!request.result) {
                        // not installed
                        d3.select("#install-button")
                            .style("visibility", "visible");
                    }
                };

                request.onerror = function() {
                    alert('Error checking installation status: ' + this.error.message);
                }
            }

            function install() {
                var request = navigator.mozApps.install("http://nolski.rocks/firefox/manifest.webapp");
                request.onsuccess = function() {
                    window.location = "http://nolski.rocks/";
                    // great - display a message, or redirect to a launch page
                };
                request.onerror = function() {
                    // whoops - this.error.name has details
                };
            }
        </script>
    </body>
</html>
